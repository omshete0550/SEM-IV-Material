CREATE TABLE DEPARTMENT(
    DNO VARCHAR2(20) PRIMARY KEY,
    DNAME VARCHAR2(20),
    MGRSTARTDATE DATE
);

desc DEPARTMENT;

CREATE TABLE EMPLOYEE(
    SSN VARCHAR2(20) PRIMARY KEY,
    FNAME VARCHAR2(20),
    LNAME VARCHAR2(20),
    Address VARCHAR2(20),
    SEX CHAR(1),
    Salary INTEGER,
    SUPERSSN REFERENCES EMPLOYEE(SSN),
    DNO REFERENCES DEPARTMENT(DNO)
);

desc EMPLOYEE;

ALTER TABLE DEPARTMENT
ADD MGRSSN REFERENCES EMPLOYEE(SSN);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSECE01','JOHN','SCOTT','BANGALORE','M', 450000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE01','JAMES','SMITH','BANGALORE','M', 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE02','HEARN','BAKER','BANGALORE','M', 700000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE03','EDWARD','SCOTT','MYSORE','M', 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE04','PAVAN','HEGDE','MANGALORE','M', 650000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE05','GIRISH','MALYA','MYSORE','M', 450000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSCSE06','NEHA','SN','BANGALORE','F', 800000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSACC01','AHANA','K','MANGALORE','F', 350000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSACC02','SANTHOSH','KUMAR','MANGALORE','M', 300000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSISE01','VEENA','M','MYSORE','M', 600000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, Address, SEX, Salary)
VALUES ('RNSIT01','NAGESH','HR','BANGALORE','M', 500000);

SELECT *
FROM EMPLOYEE;

INSERT INTO DEPARTMENT 
VALUES (1,'ACCOUNTS','01-JAN-01','RNSACC02');
INSERT INTO DEPARTMENT 
VALUES (2,'IT','01-AUG-16','RNSIT01');
INSERT INTO DEPARTMENT 
VALUES (3,'ECE','01-JUN-08','RNSECE01');
INSERT INTO DEPARTMENT 
VALUES (4,'ISE','01-AUG-15','RNSISE01');
INSERT INTO DEPARTMENT 
VALUES (5,'CSE','01-JUN-02','RNSCSE05');

SELECT *
FROM DEPARTMENT;

UPDATE EMPLOYEE 
SET SUPERSSN = NULL, DNO = '3' 
WHERE SSN = 'RNSECE01';
UPDATE EMPLOYEE 
SET SUPERSSN = 'RNSCSE02', DNO = '5' 
WHERE SSN = 'RNSCSE01';
UPDATE EMPLOYEE 
SET SUPERSSN = 'RNSCSE03', DNO = '5' 
WHERE SSN = 'RNSCSE02';
UPDATE EMPLOYEE 
SET SUPERSSN = 'RNSCSE04', DNO = '5' 
WHERE SSN = 'RNSCSE03';
UPDATE EMPLOYEE 
SET SUPERSSN = 'RNSCSE05', DNO = '5' 
WHERE SSN = 'RNSCSE04';
UPDATE EMPLOYEE 
SET DNO='5', SUPERSSN='RNSCSE06' 
WHERE SSN = 'RNSCSE05';
UPDATE EMPLOYEE 
SET DNO='5', SUPERSSN = NULL 
WHERE SSN = 'RNSCSE06';
UPDATE EMPLOYEE 
SET DNO='1', SUPERSSN = 'RNSACC02' 
WHERE SSN='RNSACC01';
UPDATE EMPLOYEE 
SET DNO='1', SUPERSSN = NULL 
WHERE SSN = 'RNSACC02';
UPDATE EMPLOYEE 
SET DNO='4', SUPERSSN = NULL 
WHERE SSN = 'RNSISE01';
UPDATE EMPLOYEE 
SET DNO='2', SUPERSSN = NULL 
WHERE SSN = 'RNSIT01';

SELECT E.FNAME, E.LNAME, 1.1*E.Salary AS INCR_SAL
FROM EMPLOYEE E, DEPARTMENT D, EMPLOYEE W
WHERE E.SSN = W.SSN AND E.DNO = D.DNO AND D.DNAME = 'ACCOUNTS';

SELECT SUM(E.Salary), MAX(E.Salary), MIN(E.Salary), AVG(Salary)
FROM EMPLOYEE E, DEPARTMENT D
WHERE E.DNO = D.DNO AND DNAME = 'ACCOUNTS';

SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE EXISTS
(
    SELECT DNO 
    FROM EMPLOYEE
    WHERE E.DNO = 5
);

SELECT DNAME, COUNT(*)
FROM EMPLOYEE E, DEPARTMENT D
WHERE D.DNO = E.DNO
AND D.DNO IN
(
    SELECT E1.DNO
    FROM EMPLOYEE E1
    GRUOP BY E1.DNO
    HAVING COUNT(*) > 2
)
ORDER BY DNO;

ALTER TABLE EMPLOYEE
ADD (BDATE DATE);

UPDATE EMPLOYEE
SET BDATE = TO_DATE('10-APR-1990', 'DD-MM-YYYY')
WHERE SSN = 'RNSECE01';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('25-DEC-1995', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE01';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-JAN-1990', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE03';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-JAN-2000', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE02';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-JAN-1998', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE04';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-JUL-2003', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE05';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-DEC-1965', 'DD-MM-YYYY')
WHERE SSN = 'RNSCSE06';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('25-SEP-1973', 'DD-MM-YYYY')
WHERE SSN = 'RNSACC01';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('11-JUL-2004', 'DD-MM-YYYY')
WHERE SSN = 'RNSACC02';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-FEB-1981', 'DD-MM-YYYY')
WHERE SSN = 'RNSISE01';

UPDATE EMPLOYEE
SET BDATE = TO_DATE('01-JUL-1955', 'DD-MM-YYYY')
WHERE SSN = 'RNSIT01';

SELECT E.FNAME, E.LNAME, E.BDATE
FROM EMPLOYEE E
WHERE EXTRACT (YEAR FROM BDATE) BETWEEN 1990 AND 1999;

// VIEW

CREATE VIEW sales_staff AS
SELECT FNAME, SSN, DNO
FROM EMPLOYEE
WHERE DNO = 5

CREATE VIEW sales_staff_check AS
SELECT FNAME, SSN, DNO
FROM EMPLOYEE
WHERE DNO = 5
WITH CHECK OPTION;

UPDATE sales_staff_check
SET FNAME = 'OM'
WHERE FNAME = 'John';

SELECT *
FROM sales_staff;

// PROCEDURE

CREATE TABLE TUPLE(
    A INTEGER,
    B CHAR(10)
);

CREATE PROCEDURE ADDTUPLE1(X IN NUMBER)
AS 
BEGIN
	INSERT INTO TUPLE VALUES(X, 'abc');
END ADDTUPLE1;

BEGIN
ADDTUPLE1(69);
END;

SELECT *
FROM TUPLE;



// Functions

CREATE FUNCTION calc_age (dob IN DATE)
RETURN NUMBER
IS
age NUMBER;
BEGIN
age := TRUNC(MONTHS_BETWEEN(SYSDATE, dob) / 12);
RETURN age;
END;

DECLARE	
emp_age NUMBER;
BEGIN
emp_age := calc_age(TO_DATE('01-JUL-2003', 'DD-MON-YYYY'));
DBMS_OUTPUT.PUT_LINE('Employee Age: ' || emp_age);
END;